# Атрибуты заявки на неавтоматизированную услугу

При создании записи заявки на неавтоматизированную услугу возможно прикрепить к
ней произвольные атрибуты. Значение любого атрибута является строкой или
значением `nil` (`NULL`). В течение жизненного цикла заявки на
неавтоматизированную услугу бизнес-логика оперирует следующими атрибутами,
значения которых используются и/или выставляются функциями модуля
бизнес-логики.

*   `added_to_pending_at` — дата и время последнего добавления заявки в реестр
    передаваемой корреспонденции.

    -   Формат значения — ISO 8601.
    -   Не используется никакой функцией.
    -   Выставляется равным текущим дате и времени функцией
        `add_to_pending_list`.
    -   Выставляется равным `nil` функцией `remove_from_pending_list`.

*   `added_to_rejecting_at` — дата и время выставления статуса `rejecting`.

    -   Формат значения — ISO 8601.
    -   Используется функцией `export_register` в проверке на то, какой статус
        выставить заявке.
        +   Непустое значение приводит к тому, что функция `export_register`
            выставляет статус заявки `closed`.
        +   Отсутствие атрибута или пустое значение приводят к тому, что
            функция `export_register` выставляет статус заявки `processing`.
    -   Выставляется функцией `reject_result` равным текущим дате и времени.

*   `back_office_id` — идентификатор карточки бэк-офиса, из которого заявка
    отправляется на обработку в ведомство.

    -   Используется в функции `add_to_pending_list` для нахождения и (при
        необходимости) создания записи реестра передаваемой корреспонденции.
    -   Не выставляется никакой функцией, должен быть задан при создании
        заявки.

*   `closed_at` — дата и время выставления статуса `closed`.

    -   Формат значения — ISO 8601.
    -   Не используется никакой функцией.
    -   Выставляется функцией `issue` равным текущим дате и времени.

*   `docs_sent_at` — дата и время отправки документов заявки в ведомство.

    -   Формат значения — ISO 8601.
    -   Не используется никакой функцией.
    -   Выставляется функцией `export_register` равным текущим времени и дате.

*   `institution_rguid` — RGUID ведомства, в котором происходит обработка
    заявки.

    -   Используется в функции `add_to_pending_list` для нахождения и (при
        необходимости) создания записи реестра передаваемой корреспонденции.
    -   Не выставляется никакой функцией, должен быть задан при создании
        заявки.

*   `issued_at` — дата и время выдачи результата оказания неавтоматизированной
    услуги, на которую была подана заявка.

    -   Формат значения — ISO 8601.
    -   Не используется никакой функцией.
    -   Выставляется функцией `issue` равным текущим дате и времени.

*   `issue_location_type` — тип места выдачи результата оказания
    неавтоматизированной услуги, на которую была подана заявка.

    -   Используется в функции `export_register` в проверке на то, какой статус
        выставить заявке.
        +   Значение `institution` приводит к тому, что функция
            `export_register` выставляет статус заявки `closed`.
        +   Остальные значения ведут к дополнительным проверкам значений других
            атрибутов.
    -   Не выставляется никакой функцией, должен быть задан при создании
        заявки.

*   `issuer_person_id` — идентификатор карточки оператора фронт-офиса,
    выдавшего результат оказания неавтоматизированной услуги, на которую была
    подана заявка.

    -   Не используется никакой функцией.
    -   Выставляется функцией `issue` равным значению параметра `operator_id`
        ассоциативного массива параметров функции.

*   `processor_person_id` — идентификатор карточки оператора бэк-офиса,
    отправившего в ведомство документы заявки в составе реестра передаваемой
    корреспонденции.

    -   Не используется никакой функцией.
    -   Выставляется функцией `export_register` равным значению параметра
        `exporter_id` ассоциативного массива параметров функции.

*   `rejecting_expected_at` — дата, начиная с которой результат заявки должен
    быть возвращён в ведомство.

    -   Формат значения — ISO 8601.
    -   Используется функциями `issue` и `reject_result` в проверке на то,
        можно ли выставить новый статус заявке (`closed` и `rejecting`
        соответственно).
    -   Не выставляется никакой функцией, должен быть задан при создании
        заявки.

*   `responded_at` — дата и время передачи результата оказания
    неавтоматизированной услуги, на которую была подана заявка, во фронт-офис.

    -   Формат значения — ISO 8601.
    -   Не используется никакой функцией.
    -   Выставляется функцией `send_to_frontoffice` равным текущим дате и
        времени.

*   `response_processor_person_id` — идентификатор карточки оператора
    бэк-офиса, передавшего во фронт-офис результат оказания
    неавтоматизированной услуги, на которую была подана заявка.

    -   Не используется никакой функцией.
    -   Выставляется функцией `send_to_frontoffice` равным значению параметра
        `operator_id` ассоциативного массива параметров функции.

*   `result_id` — идентификатор результата оказания неавтоматизированной
    услуги, на которую была подана заявка.

    -   Не используется никакой функцией.
    -   Выставляется функцией `send_to_frontoffice` равным значению параметра
        `result_id` ассоциативного массива параметров функции.

*   `status` — состояние заявки. Подробнее о поддерживаемых значениях можно
    прочитать в документе `STATES.md`, посвящённом статусной модели заявки на
    неавтоматизированную услугу.

    -   Используется и выставляется всеми функциями.
