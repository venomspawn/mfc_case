# Библиотека бизнес-логики заявки на неавтоматизированную услугу

Библиотека предоставляет бизнес-логику заявки на неавтоматизированную услугу
сервису `case_core`.

## Запуск отладочной консоли и тестов

Для запуска отладочной консоли и тестов рекомендуется использовать виртуальную
машину, которую можно запустить с помощью команды `vagrant up` в терминале
(здесь и далее подразумевается, что текущий путь терминала указывает на
корневую директорию Git-репозитория библиотеки). После создания, запуска и
настройки виртуальной машины необходимо зайти в неё с помощью команды
`vagrant ssh`. Следующие команды выполняются в терминале виртуальной машины:

*   `bundle install` — установка необходимых библиотек после создания
    виртуальной машины;

*   `make debug` — запуск отладочной IRB-консоли;

*   `make test` — запуск тестов.

## Сборка

Для сборки библиотеки в Gem-файл можно использовать команду `make build`.
Gem-файл создаётся в корневой директории Git-репозитория библиотеки.

## Непрерывная интеграция Gitlab

При создании нового тега с номером версии Gitlab автоматически собирает
библиотеку и помещает её в [сервер библиотек](http://nexus.it2.vm).

## Использование

Для установки бизнес-логики, предоставляемой библиотекой, необходимо
использовать следующую команду в терминале в директории с запущенным сервисом
`case_core`:

```
bundle exec rake case_core:fetch_logic[mfc_case]
```

При этом произойдёт загрузка последней версии библиотеки с сервера библиотек, а
также распаковка загруженного Gem-файла в директорию с бизнес-логикой сервиса
`case_core`. Сервис автоматически загрузит последнюю версию библиотеки в память
своего процесса.
